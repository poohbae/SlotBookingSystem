{% extends "base.html" %}
{% block title %}Admin Dashboard - Medcare App{% endblock %}
{% block content %}

<div class="dashboard-container">
    <h1>Welcome, Admin <i class="fa-solid fa-hand"></i></h1>

    {% if not two_factor_enabled %}
    <div class="alert alert-warning" style="margin: 20px; text-align:center;">
        <i class="fa-solid fa-shield-halved"></i>
        <b>Secure your account:</b> You havenâ€™t enabled Two-Factor Authentication yet.
        <a href="{{ url_for('twofa_setup') }}" class="btn">Set Up 2FA</a>
    </div>
    {% endif %}

    <!-- Appointment Overview -->
    <h2 class="list-title">All Appointments</h2>
    <table class="appointment-table">
        <thead>
            <tr>
                <th>Patient</th>
                <th>Doctor</th>
                <th>Specialization</th>
                <th>Date</th>
                <th>Time</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
            {% if appointments and appointments|length > 0 %}
                {% for appt in appointments %}
                <tr>
                    <td>{{ appt['patient_name'] }}</td>
                    <td>{{ appt['doctor_name'] }}</td>
                    <td>{{ appt['doctor_specialization'] }}</td>
                    <td>{{ appt['date'] }}</td>
                    <td>{{ appt['time'] }}</td>
                    <td>
                        <span class="status status-{{ appt['status'] }}">{{ appt['status'] | capitalize }}</span>
                    </td>
                </tr>
                {% endfor %}
            {% else %}
                <tr>
                    <td colspan="6" class="empty">
                        No appointments booked yet.
                    </td>
                </tr>
            {% endif %}
        </tbody>
    </table>

    <!-- Registered Doctors -->
    <h2 class="list-title"">Registered Doctors</h2>
        <div id="doctor-list" class="doctor-list">
        {% if doctors %}
            {% for doc in doctors %}
            <div class="appointment-card">
                
                <!-- Doctor name centered -->
                <div style="text-align: center; margin-bottom: 10px;">
                    <strong style="font-size: 1.2em; color: #0b2e59;">
                        <i class="fa-solid fa-user-doctor" style="margin-right: 6px; color:#0b2e59;"></i>
                        {{ doc['name'] }}
                    </strong>
                </div>

                <!-- Details left-aligned -->
                <div style="text-align: left;">
                    <p><i class="fa-solid fa-stethoscope" style="margin-right: 6px; color:#1E90FF;"></i><b>Specialization:</b> {{ doc['specialization'] }}</p>
                    <p><i class="fa-solid fa-briefcase" style="margin-right: 6px; color:#28a745;"></i><b>Experience:</b> {{ doc['experience_years'] }} years</p>
                    <p><i class="fa-solid fa-phone" style="margin-right: 6px; color:#ff9800;"></i><b>Phone:</b> {{ doc['phone_number'] }}</p>
                    <p><i class="fa-solid fa-envelope" style="margin-right: 6px; color:#9c27b0;"></i><b>Email:</b> {{ doc['email'] }}</p>
                </div>

                <div style="text-align: center; margin-top: 10px;">
                    <button class="cancel-btn delete-btn" data-id="{{ doc['doctor_id'] }}" 
                            style="background:#f97b88; border:none; padding:8px 12px; border-radius:6px; color:white; cursor:pointer;">
                        <i class="fa-solid fa-trash-can" style="margin-right:5px;"></i>Delete
                    </button>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <p class="empty">
                <i class="fa-regular fa-face-frown"></i>
                No doctors added yet.
            </p>
        {% endif %}
    </div>

    <!-- Add Doctor Section -->
    <div id="add-doctor-section" class="booking-container" style="margin-top: 30px;">
        <h2 style="color: #0b2e59;">Add New Doctor</h2>
        <form id="addDoctorForm">
            <label for="name">Doctor Name:</label>
            <input type="text" id="name" placeholder="Doctor Name" required>

            <label for="email">Email:</label>
            <input type="email" id="email" placeholder="Email" required>

            <label for="phone_number">Phone Number:</label>
            <input type="text" id="phone_number" placeholder="Phone Number" required>

            <label for="specialization">Specialization:</label>
            <input type="text" id="specialization" placeholder="Specialization (e.g., Cardiology)" required>

            <label for="experience">Years of Experience:</label>
            <input type="number" id="experience" placeholder="Years of Experience" min="0" required>

            <button type="submit" class="btn" style="margin-top: 15px;">Add Doctor</button>
        </form>
    </div>
</div>
{% endblock %}
